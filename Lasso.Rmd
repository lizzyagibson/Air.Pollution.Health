---
title: "Supervised Analysis"
author: "Yanelli Nunez"
date: "5/2/2018"
output: html_document
---

```{r libraries}
library(ISLR)
library(tidyverse)
library(glmnet)
library(Matrix)
library(caret)
library(ggplot2)
```

```{r data}
data_lasso = read_csv("data_2015.csv") %>% select(everything(), -Humidity, -day_of_week) %>% drop_na
```

```{r train and test set}
set.seed(1)
train_set = data_lasso[sample(nrow(data_lasso), 80),]
test_set = data_lasso[!row.names(data_lasso) %in% row.names(train_set)]

##creating a matrix model
x = model.matrix(resp ~., data_lasso)[,-(1:2)]
y = data_lasso$resp
```


```{r lasso}
lasso.mod = glmnet(x, y, alpha = 1)
plot(lasso.mod)

cv.lasso = cv.glmnet(x, y, alpha = 1)
plot(cv.lasso)
best_lambda = cv.lasso$lambda.min


dim(coef(lasso.mod))

coef(lasso.mod)[,1]

```

